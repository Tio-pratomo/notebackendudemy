---
title: "API Requests dan Authentication"
---

Setelah memahami konsep dasar API di Sesi 2.1, sekarang kita akan mempelajari cara membuat permintaan API yang terstruktur dengan benar dan berbagai metode authentication untuk mengakses API yang dilindungi. Ini adalah skill penting untuk berinteraksi dengan real-world APIs.

## Komponen Permintaan API

Setiap API request terdiri dari beberapa komponen utama yang perlu dipahami untuk berinteraksi dengan API secara efektif.

### 1. Base URL

**Base URL** adalah alamat dasar dari API server. Ini seperti alamat gedung utama sebelum menentukan ruangan spesifik.

```
https://api.example.com
https://api.github.com
https://jsonplaceholder.typicode.com
```

### 2. Endpoint

**Endpoint** adalah path spesifik setelah base URL yang menentukan resource apa yang ingin diakses. Endpoint seperti nomor ruangan atau lantai spesifik di dalam gedung.

```
https://api.example.com/users          ← endpoint: /users
https://api.example.com/users/123      ← endpoint: /users/123
https://api.example.com/posts          ← endpoint: /posts
```

**Struktur endpoint yang baik**:

- Gunakan kata benda (nouns) bukan kata kerja
- Gunakan bentuk jamak (plural) untuk collections
- Gunakan huruf kecil dan pisahkan dengan dash
- Gunakan nesting untuk relasi

```
✅ Good:
/users
/users/123
/users/123/posts
/products/categories

❌ Bad:
/getUsers
/User
/users_list
```

## Path Parameters vs Query Parameters

Dua cara utama untuk mengirim data dalam URL API request adalah path parameters dan query parameters. Memahami kapan menggunakan masing-masing sangat penting.

### Path Parameters

**Path parameters** adalah bagian dari URL path yang digunakan untuk **mengidentifikasi resource spesifik**. Bersifat **required** dan merupakan bagian integral dari endpoint.

**Format**: `/resource/{parameter}/sub-resource/{parameter}`

**Contoh**:

```
GET /users/123
     └── path parameter (user ID)

GET /posts/456/comments/789
     └── post ID    └── comment ID

GET /products/laptop-xyz
           └── product slug
```

**Kapan menggunakan path parameters**:

- Untuk identifier resource (ID, username, slug)
- Untuk hierarchical data (parent-child relationship)
- Ketika parameter adalah required
- Untuk RESTful API design

**Implementasi di Express.js**:

```javascript
// Single path parameter
app.get("/users/:userId", (req, res) => {
  const userId = req.params.userId;
  res.json({ userId, name: "John Doe" });
});

// Multiple path parameters
app.get("/users/:userId/posts/:postId", (req, res) => {
  const { userId, postId } = req.params;
  res.json({
    userId,
    postId,
    message: `Post ${postId} by user ${userId}`,
  });
});

// Dynamic routes with patterns
app.get("/products/:category/:productId", (req, res) => {
  const { category, productId } = req.params;
  res.json({ category, productId });
});
```

### Query Parameters

**Query parameters** digunakan untuk **filtering, sorting, pagination, atau memberikan opsi tambahan** pada request. Bersifat **optional** dan ditambahkan setelah `?` di URL.

**Format**: `/resource?key1=value1&key2=value2`

**Contoh**:

```
GET /users?role=admin&status=active
         └── query parameters

GET /products?category=electronics&sort=price&order=desc&page=2&limit=20
           └── multiple query parameters

GET /search?q=javascript&lang=en&results=10
```

**Kapan menggunakan query parameters**:

- Untuk filtering data (`?category=electronics`)
- Untuk sorting (`?sort=price&order=desc`)
- Untuk pagination (`?page=2&limit=20`)
- Untuk search queries (`?q=keyword`)
- Untuk optional features (`?include=comments`)

**Implementasi di Express.js**:

```javascript
app.get("/products", (req, res) => {
  // Destructure query parameters
  const {
    category,
    minPrice,
    maxPrice,
    sort = "name", // default value
    order = "asc", // default value
    page = 1, // default value
    limit = 10, // default value
  } = req.query;

  // Build response
  let message = "Searching products";

  if (category) {
    message += ` in category: ${category}`;
  }

  if (minPrice && maxPrice) {
    message += ` with price between ${minPrice} and ${maxPrice}`;
  }

  res.json({
    message,
    filters: { category, minPrice, maxPrice },
    sorting: { sort, order },
    pagination: { page: parseInt(page), limit: parseInt(limit) },
  });
});
```

### Perbandingan Path vs Query Parameters

| Aspek          | Path Parameters       | Query Parameters            |
| -------------- | --------------------- | --------------------------- |
| **Posisi**     | Bagian dari URL path  | Setelah `?` di URL          |
| **Sifat**      | Required              | Optional                    |
| **Penggunaan** | Identifikasi resource | Filter, sort, pagination    |
| **Format**     | `/users/123`          | `?role=admin&status=active` |
| **RESTful**    | Ya                    | Ya                          |
| **Contoh**     | User ID, Post ID      | Search term, filters        |

## Request Headers

**Headers** adalah metadata yang dikirim bersama request untuk memberikan informasi tambahan tentang request atau memberikan credentials untuk authentication.

### Headers Umum

**Content-Type**: Menunjukkan format data yang dikirim di body

```
Content-Type: application/json
Content-Type: application/x-www-form-urlencoded
Content-Type: multipart/form-data
```

**Accept**: Menunjukkan format data yang diinginkan di response

```
Accept: application/json
Accept: text/html
Accept: */*
```

**Authorization**: Berisi credentials untuk authentication

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
```

**User-Agent**: Informasi tentang client yang membuat request

```
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
```

**Custom Headers**: Biasanya dimulai dengan `X-`

```
X-API-Key: your-api-key-here
X-Request-ID: 123456
X-Custom-Header: custom-value
```

## Request Body

**Request body** digunakan untuk mengirim data yang lebih kompleks atau besar dalam request, biasanya untuk POST, PUT, dan PATCH methods.

### Format JSON Body

```json
{
  "name": "John Doe",
  "email": "john@example.com",
  "age": 30,
  "address": {
    "street": "123 Main St",
    "city": "Jakarta"
  },
  "hobbies": ["reading", "coding", "traveling"]
}
```

### Format URL-encoded Body

```
name=John+Doe&email=john%40example.com&age=30
```

## API Authentication Methods

Authentication adalah proses memverifikasi identitas user atau application yang mengakses API. Berbagai metode authentication memiliki level keamanan yang berbeda.

### 1. No Authentication

API publik yang tidak memerlukan authentication. Siapa saja bisa mengakses tanpa credentials.

**Contoh**:

```javascript
// Bored API - aktivitas random
const response = await fetch("https://bored-api.appbrewery.com/random");
const data = await response.json();
console.log(data.activity);

// ISS Location API
const issResponse = await fetch(
  "https://api.wheretheiss.at/v1/satellites/25544"
);
const issData = await issResponse.json();
console.log(issData.latitude, issData.longitude);
```

**Keuntungan**: Simple, mudah digunakan
**Kerugian**: Tidak ada tracking, rate limiting sulit, data bisa disalahgunakan

### 2. Basic Authentication

Method sederhana yang mengirim username dan password di header request. Credentials di-encode dengan Base64.

**Format Header**:

```
Authorization: Basic base64(username:password)
```

**Cara kerja**:

1. Combine username dan password dengan colon: `username:password`
2. Encode dengan Base64
3. Kirim di Authorization header

**Contoh dengan Postman**:

- Di Authorization tab, pilih "Basic Auth"
- Masukkan username dan password
- Postman akan otomatis encode dan set header

**Contoh dengan Axios**:

```javascript
import axios from "axios";

// Method 1: Menggunakan auth config
const response = await axios.get("https://api.example.com/data", {
  auth: {
    username: "your-username",
    password: "your-password",
  },
});

// Method 2: Manual header
const credentials = Buffer.from("username:password").toString("base64");
const response2 = await axios.get("https://api.example.com/data", {
  headers: {
    Authorization: `Basic ${credentials}`,
  },
});
```

**Keamanan**:

- Harus menggunakan HTTPS karena credentials bisa di-decode dengan mudah
- Credentials dikirim di setiap request
- Tidak ada mekanisme expiration

### 3. API Key Authentication

API Key adalah token unik yang digunakan untuk mengidentifikasi dan authenticate application yang mengakses API.

**3 cara mengirim API Key**:

**a) Query Parameter**:

```
GET https://api.example.com/data?apiKey=your-secret-key-123
```

**b) Request Header** (lebih aman):

```
X-API-Key: your-secret-key-123
```

**c) Authorization Header**:

```
Authorization: ApiKey your-secret-key-123
```

**Contoh dengan Axios**:

```javascript
// Query parameter
const response = await axios.get("https://api.example.com/data", {
  params: {
    apiKey: "your-secret-key-123",
  },
});

// Header
const response2 = await axios.get("https://api.example.com/data", {
  headers: {
    "X-API-Key": "your-secret-key-123",
  },
});
```

**Best Practices**:

- Simpan API key di environment variables, jangan hardcode
- Jangan commit API key ke version control
- Regenerate API key secara berkala
- Gunakan different keys untuk development dan production

```javascript
// .env file
API_KEY=your-secret-key-123
API_BASE_URL=https://api.example.com

// app.js
import dotenv from 'dotenv';
dotenv.config();

const apiKey = process.env.API_KEY;
const apiUrl = process.env.API_BASE_URL;
```

### 4. Bearer Token Authentication (OAuth 2.0)

Method authentication paling aman dan modern. Token diperoleh setelah login dan digunakan untuk subsequent requests.

**Cara kerja**:

1. User login dengan username dan password
2. Server generate token dan kirim ke client
3. Client menyimpan token (localStorage, sessionStorage, cookie)
4. Setiap request, kirim token di Authorization header
5. Token bisa di-expire dan di-refresh

**Format Header**:

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Contoh Flow**:

```javascript
import axios from "axios";

// Step 1: Login untuk mendapatkan token
const loginResponse = await axios.post("https://api.example.com/auth/login", {
  username: "john_doe",
  password: "password123",
});

const token = loginResponse.data.token;
console.log("Token received:", token);

// Step 2: Simpan token (bisa di localStorage atau state management)
localStorage.setItem("authToken", token);

// Step 3: Gunakan token untuk API calls
const dataResponse = await axios.get("https://api.example.com/protected/data", {
  headers: {
    Authorization: `Bearer ${token}`,
  },
});

console.log("Protected data:", dataResponse.data);

// Step 4: Logout - hapus token
localStorage.removeItem("authToken");
```

**Implementasi dengan Axios Interceptor** (recommended):

```javascript
import axios from "axios";

// Create axios instance
const api = axios.create({
  baseURL: "https://api.example.com",
});

// Request interceptor - auto attach token
api.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem("authToken");
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// Response interceptor - handle token expiration
api.interceptors.response.use(
  (response) => response,
  async (error) => {
    if (error.response?.status === 401) {
      // Token expired, redirect to login
      localStorage.removeItem("authToken");
      window.location.href = "/login";
    }
    return Promise.reject(error);
  }
);

// Gunakan api instance
const response = await api.get("/protected/data");
```

**Keuntungan Bearer Token**:

- Token bisa di-expire (lebih aman)
- Bisa di-revoke kapan saja
- Bisa berisi user info (JWT)
- Stateless (server tidak perlu menyimpan session)
- Scalable untuk microservices

## Testing API dengan Postman

**Postman** adalah tool powerful untuk testing dan development API.

### Setup Basic Request

1. **Create new request**
2. **Select method** (GET, POST, PUT, DELETE)
3. **Enter URL** dengan endpoint
4. **Add parameters** jika perlu

### Testing dengan Different Authentication

**No Auth**:

```
GET https://bored-api.appbrewery.com/random
No authentication needed
```

**Basic Auth**:

```
GET https://api.example.com/users
Authorization tab → Basic Auth
Username: your-username
Password: your-password
```

**API Key**:

```
GET https://api.example.com/data
Params tab → Add key-value
Key: apiKey
Value: your-key-123

OR

Headers tab → Add header
Key: X-API-Key
Value: your-key-123
```

**Bearer Token**:

```
GET https://api.example.com/protected/data
Authorization tab → Bearer Token
Token: your-jwt-token-here
```

## Contoh Praktis: Weather API dengan Authentication

```javascript
import axios from "axios";
import dotenv from "dotenv";

dotenv.config();

const WEATHER_API_KEY = process.env.WEATHER_API_KEY;
const BASE_URL = "https://api.openweathermap.org/data/2.5";

// Get weather by city name
async function getWeather(city) {
  try {
    const response = await axios.get(`${BASE_URL}/weather`, {
      params: {
        q: city,
        appid: WEATHER_API_KEY,
        units: "metric",
        lang: "id",
      },
    });

    const data = response.data;
    console.log(`Cuaca di ${data.name}:`);
    console.log(`Suhu: ${data.main.temp}°C`);
    console.log(`Kondisi: ${data.weather.description}`);
    console.log(`Kelembaban: ${data.main.humidity}%`);

    return data;
  } catch (error) {
    if (error.response) {
      console.error(
        "Error:",
        error.response.status,
        error.response.data.message
      );
    } else {
      console.error("Network error:", error.message);
    }
    throw error;
  }
}

// Get weather by coordinates
async function getWeatherByCoords(lat, lon) {
  try {
    const response = await axios.get(`${BASE_URL}/weather`, {
      params: {
        lat: lat,
        lon: lon,
        appid: WEATHER_API_KEY,
        units: "metric",
      },
    });

    return response.data;
  } catch (error) {
    console.error("Error:", error.message);
    throw error;
  }
}

// Usage
getWeather("Jakarta");
getWeatherByCoords(-6.2088, 106.8456); // Jakarta coordinates
```

## Best Practices API Requests

**Use environment variables**: Jangan hardcode API keys atau sensitive data di kode.

**Handle errors properly**: Selalu handle network errors dan API errors dengan try-catch.

**Validate responses**: Check status codes dan validate data structure sebelum menggunakan.

**Rate limiting**: Respect API rate limits, implement retry logic dengan exponential backoff.

**Cache responses**: Cache data yang jarang berubah untuk mengurangi API calls.

**Use HTTPS**: Selalu gunakan HTTPS untuk API calls, terutama dengan authentication.

**Log requests**: Log API requests untuk debugging, tapi jangan log sensitive data.

**Implement timeouts**: Set request timeout untuk mencegah hanging requests.

```javascript
const response = await axios.get(url, {
  timeout: 5000, // 5 seconds timeout
  maxRedirects: 5,
});
```

---

**Ringkasan**: Structuring API requests melibatkan pemahaman tentang base URL, endpoints, path parameters untuk identifikasi resource, query parameters untuk filtering dan pagination, headers untuk metadata dan authentication, serta request body untuk data kompleks. Authentication methods berkembang dari no auth (publik), basic auth (username:password di-encode Base64), API key (token di query/header), hingga bearer token (OAuth 2.0 dengan JWT yang paling aman dan modern). Setiap method memiliki use case dan level keamanan yang berbeda. Memahami kapan dan bagaimana menggunakan each component dan authentication method adalah essential skill untuk bekerja dengan modern web APIs dan building secure applications.
